import{j as ie,k as ne,n as oe}from"./chunk-H6JEJQHG.js";import{a as ae}from"./chunk-FNZ3CGE5.js";import{a as re}from"./chunk-TNVVAGLP.js";import{B as K,F as Y,K as Z,L as ee,M as te,c as j,g as B,h as W,i as Q,l as G,n as O,v as R,w as U,x as X,y as H,z as J}from"./chunk-ESOQDHF6.js";import{f as L}from"./chunk-T2HTACBN.js";import{Aa as $,Kb as q,La as x,Ma as g,N as T,Na as k,Oa as w,Pa as E,Qa as p,Ra as i,S as u,Sa as n,T as _,Ta as v,Ua as C,Va as m,Wa as c,Za as D,a as V,ab as F,b as S,ba as f,bb as l,cb as b,db as h,eb as P,jb as N,kb as z,lb as I,pa as r,wb as A}from"./chunk-KIKRUHUI.js";var M=(o,t)=>t.id;function le(o,t){if(o&1){let e=C();i(0,"button",24),m("click",function(){u(e);let a=c();return _(a.clearSearch())}),v(1,"lucide-icon",25),n()}if(o&2){let e=c();r(),p("img",e.XIcon)("size",18)}}function ce(o,t){if(o&1){let e=C();i(0,"h3",27),l(1,"No visits found"),n(),i(2,"p",28),l(3,"Try adjusting your filters"),n(),i(4,"button",29),m("click",function(){u(e);let a=c(2);return a.clearSearch(),a.setStatusFilter("all"),_(a.setBalanceFilter("all"))}),l(5," Clear all filters "),n()}}function de(o,t){o&1&&(i(0,"h3",27),l(1,"No visits yet"),n(),i(2,"p",30),l(3,"Visits will appear here when created"),n())}function me(o,t){if(o&1&&(i(0,"div",21),v(1,"lucide-icon",26),x(2,ce,6,0)(3,de,4,0),n()),o&2){let e=c();r(),p("img",e.FileTextIcon)("size",48),r(),g(e.searchQuery()||e.statusFilter()!=="all"||e.balanceFilter()!=="all"?2:3)}}function pe(o,t){if(o&1&&(i(0,"span"),l(1),n()),o&2){c(2);let e=I(0);r(),P("",e.procedures.length," procedure",e.procedures.length!==1?"s":"")}}function ue(o,t){if(o&1&&(i(0,"p",42),l(1),n()),o&2){let e=c(2).$implicit;r(),b(e.diagnosis)}}function _e(o,t){if(o&1&&(i(0,"p",47),l(1),n()),o&2){c(2);let e=I(0);r(),h("",e.balance," EGP owed")}}function xe(o,t){o&1&&(i(0,"p",48),l(1,"Paid in full"),n())}function ge(o,t){if(o&1){let e=C();i(0,"div",32),m("click",function(){u(e);let a=c().$implicit,d=c(2);return _(d.openDetailsModal(a))}),i(1,"div",4)(2,"div",33)(3,"div",34),v(4,"lucide-icon",35),n(),i(5,"div",36)(6,"div",37)(7,"h3",38),l(8),n(),i(9,"span"),l(10),n()(),i(11,"div",39)(12,"div",40),v(13,"lucide-icon",41),l(14),n(),i(15,"div",40),v(16,"lucide-icon",41),l(17),n(),x(18,pe,2,2,"span"),n(),x(19,ue,2,1,"p",42),n()(),i(20,"div",43)(21,"div",44)(22,"p",45),l(23,"Total Cost"),n(),i(24,"p",46),l(25),n(),x(26,_e,2,1,"p",47)(27,xe,2,0,"p",48),n(),i(28,"button",49),m("click",function(a){u(e);let d=c().$implicit,y=c(2);return a.stopPropagation(),_(y.deleteVisit(d))}),v(29,"lucide-icon",25),n()()()()}if(o&2){let e=c().$implicit,s=I(0),a=c(2);r(4),p("img",a.getStatusIcon(e.status))("size",24),r(4),b(s.patientName),r(),F("px-3 py-1 rounded-full text-xs font-medium "+a.getStatusColor(e.status)),r(),h(" ",e.status.toUpperCase().replace("-"," ")," "),r(3),p("img",a.PhoneIcon)("size",14),r(),h(" ",a.formatPhone(s.patientPhone||"")," "),r(2),p("img",a.CalendarIcon)("size",14),r(),h(" ",a.formatDateTime(e.date)," "),r(),g(s.procedures.length>0?18:-1),r(),g(e.diagnosis?19:-1),r(6),h("",e.totalCost," EGP"),r(),g(s.balance>0?26:e.totalCost>0?27:-1),r(3),p("img",a.Trash2Icon)("size",18)}}function ve(o,t){if(o&1&&(N(0),x(1,ge,30,18,"div",31)),o&2){let e=t.$implicit,s=c(2),a=z(s.visitService.getVisitWithDetails(e.id,s.patientService));r(),g(a?1:-1)}}function Ce(o,t){if(o&1&&(i(0,"div",22),w(1,ve,2,2,null,null,M),n()),o&2){let e=c();r(),E(e.filteredVisits())}}function he(o,t){if(o&1){let e=C();i(0,"div",58)(1,"h3",73),l(2,"Diagnosis & Notes"),n(),i(3,"div",74)(4,"div")(5,"label",75),l(6,"Diagnosis"),n(),v(7,"textarea",76,0),n(),i(9,"div")(10,"label",75),l(11,"Doctor Notes"),n(),v(12,"textarea",77,1),n(),i(14,"button",78),m("click",function(){u(e);let a=D(8),d=D(13),y=c(2);return _(y.saveDiagnosis(a.value,d.value))}),l(15," Save Notes "),n()()()}if(o&2){let e=c(2);r(7),p("value",e.selectedVisit().diagnosis),r(5),p("value",e.selectedVisit().notes)}}function fe(o,t){if(o&1&&(i(0,"div",79)(1,"p",80),l(2,"Diagnosis"),n(),i(3,"p",81),l(4),n()()),o&2){let e=c(3);r(4),b(e.selectedVisit().diagnosis)}}function ye(o,t){if(o&1&&(i(0,"div")(1,"p",80),l(2,"Notes"),n(),i(3,"p",81),l(4),n()()),o&2){let e=c(3);r(4),b(e.selectedVisit().notes)}}function be(o,t){if(o&1&&(i(0,"div",59),x(1,fe,5,1,"div",79),x(2,ye,5,1,"div"),n()),o&2){let e=c(2);r(),g(e.selectedVisit().diagnosis?1:-1),r(),g(e.selectedVisit().notes?2:-1)}}function Ve(o,t){if(o&1){let e=C();i(0,"button",82),m("click",function(){u(e);let a=c(2);return _(a.toggleProcedureForm())}),v(1,"lucide-icon",25),i(2,"span"),l(3,"Add Procedure"),n()()}if(o&2){let e=c(2);r(),p("img",e.PlusIcon)("size",16)}}function Se(o,t){if(o&1){let e=C();i(0,"div",63)(1,"h4",83),l(2,"Add New Procedure"),n(),i(3,"div",84)(4,"input",85),m("input",function(a){u(e);let d=c(2);return _(d.updateProcedureName(a.target.value))}),n(),i(5,"input",86),m("input",function(a){u(e);let d=c(2);return _(d.updateProcedureTooth(a.target.value))}),n(),i(6,"input",87),m("input",function(a){u(e);let d=c(2);return _(d.updateProcedurePrice(a.target.value))}),n()(),i(7,"div",88)(8,"button",89),m("click",function(){u(e);let a=c(2);return _(a.addProcedure())}),l(9," Add "),n(),i(10,"button",90),m("click",function(){u(e);let a=c(2);return _(a.toggleProcedureForm())}),l(11," Cancel "),n()()()}if(o&2){let e=c(2);r(4),p("value",e.procedureForm().name),r(),p("value",e.procedureForm().tooth),r(),p("value",e.procedureForm().price)}}function we(o,t){o&1&&(i(0,"p",64),l(1,"No procedures added yet"),n())}function Ee(o,t){if(o&1&&(i(0,"p",93),l(1),n()),o&2){let e=c().$implicit;r(),h("Tooth: ",e.tooth)}}function Pe(o,t){if(o&1){let e=C();i(0,"button",97),m("click",function(){u(e);let a=c().$implicit,d=c(3);return _(d.removeProcedure(a.id))}),v(1,"lucide-icon",25),n()}if(o&2){let e=c(4);r(),p("img",e.XIcon)("size",18)}}function Fe(o,t){if(o&1&&(i(0,"div",91)(1,"div")(2,"p",92),l(3),n(),x(4,Ee,2,1,"p",93),n(),i(5,"div",94)(6,"span",95),l(7),n(),x(8,Pe,2,2,"button",96),n()()),o&2){let e=t.$implicit,s=c(3);r(3),b(e.name),r(),g(e.tooth?4:-1),r(3),h("",e.price," EGP"),r(),g(s.selectedVisit().status!=="completed"?8:-1)}}function Te(o,t){if(o&1&&(i(0,"div",65),w(1,Fe,9,4,"div",91,M),n()),o&2){let e=c(2);r(),E(e.selectedVisit().procedures)}}function Ie(o,t){if(o&1){let e=C();i(0,"button",98),m("click",function(){u(e);let a=c(2);return _(a.togglePrescriptionForm())}),v(1,"lucide-icon",25),i(2,"span"),l(3,"Add Prescription"),n()()}if(o&2){let e=c(2);r(),p("img",e.PlusIcon)("size",16)}}function ke(o,t){if(o&1){let e=C();i(0,"div",99)(1,"input",103),m("input",function(a){let d=u(e).$index,y=c(3);return _(y.updatePrescriptionItem(d,"medicine",a.target.value))}),n(),i(2,"input",104),m("input",function(a){let d=u(e).$index,y=c(3);return _(y.updatePrescriptionItem(d,"dosage",a.target.value))}),n(),i(3,"input",105),m("input",function(a){let d=u(e).$index,y=c(3);return _(y.updatePrescriptionItem(d,"frequency",a.target.value))}),n(),i(4,"input",106),m("input",function(a){let d=u(e).$index,y=c(3);return _(y.updatePrescriptionItem(d,"duration",a.target.value))}),n()()}if(o&2){let e=t.$implicit;r(),p("value",e.medicine),r(),p("value",e.dosage),r(),p("value",e.frequency),r(),p("value",e.duration)}}function De(o,t){if(o&1){let e=C();i(0,"div",63)(1,"h4",83),l(2,"Add Prescription"),n(),i(3,"div",67),w(4,ke,5,4,"div",99,k),n(),i(6,"div",88)(7,"button",100),m("click",function(){u(e);let a=c(2);return _(a.addPrescriptionItem())}),l(8," + Add Another Medicine "),n(),i(9,"div",101)(10,"button",102),m("click",function(){u(e);let a=c(2);return _(a.savePrescription())}),l(11," Save Prescription "),n(),i(12,"button",90),m("click",function(){u(e);let a=c(2);return _(a.togglePrescriptionForm())}),l(13," Cancel "),n()()()()}if(o&2){let e=c(2);r(4),E(e.prescriptionItems())}}function Me(o,t){if(o&1&&(i(0,"div",107)(1,"p",109),l(2),n(),i(3,"div",110)(4,"div")(5,"span",111),l(6,"Dosage:"),n(),i(7,"span",112),l(8),n()(),i(9,"div")(10,"span",111),l(11,"Frequency:"),n(),i(12,"span",112),l(13),n()(),i(14,"div")(15,"span",111),l(16,"Duration:"),n(),i(17,"span",112),l(18),n()()()()),o&2){let e=t.$implicit,s=t.$index;r(2),P("",s+1,". ",e.medicine),r(6),b(e.dosage),r(5),b(e.frequency),r(5),b(e.duration)}}function $e(o,t){if(o&1){let e=C();i(0,"div",67),w(1,Me,19,5,"div",107,k),i(3,"button",108),m("click",function(){u(e);let a=c(2);return _(a.printPrescription())}),v(4,"lucide-icon",25),i(5,"span"),l(6,"Print Prescription"),n()()()}if(o&2){let e=c(2);r(),E(e.selectedVisit().prescription.items),r(3),p("img",e.PrinterIcon)("size",16)}}function Ne(o,t){o&1&&(i(0,"p",64),l(1,"No prescription added yet"),n())}function ze(o,t){if(o&1){let e=C();i(0,"button",82),m("click",function(){u(e);let a=c(2);return _(a.togglePaymentForm())}),v(1,"lucide-icon",25),i(2,"span"),l(3,"Record Payment"),n()()}if(o&2){let e=c(2);r(),p("img",e.DollarSignIcon)("size",16)}}function Ae(o,t){if(o&1){let e=C();i(0,"div",63)(1,"h4",83),l(2),n(),i(3,"div",113)(4,"input",114),m("input",function(a){u(e);let d=c(2);return _(d.updateAmount(a.target.value))}),n(),i(5,"select",115),m("change",function(a){u(e);let d=c(2);return _(d.updateMethod(a.target.value))}),i(6,"option",116),l(7,"Cash"),n(),i(8,"option",117),l(9,"Visa"),n(),i(10,"option",118),l(11,"Bank Transfer"),n()()(),i(12,"div",88)(13,"button",89),m("click",function(){u(e);let a=c(2);return _(a.addPayment())}),l(14," Record Payment "),n(),i(15,"button",90),m("click",function(){u(e);let a=c(2);return _(a.togglePaymentForm())}),l(16," Cancel "),n()()()}if(o&2){let e=c(2);r(2),h("Record Payment (Balance: ",e.selectedVisit().balance," EGP)"),r(2),p("value",e.paymentForm().amount)("max",e.selectedVisit().balance),r(),p("value",e.paymentForm().method)}}function qe(o,t){o&1&&(i(0,"p",64),l(1,"No payments recorded yet"),n())}function Le(o,t){if(o&1&&(i(0,"div",91)(1,"div")(2,"p",92),l(3),n(),i(4,"p",119),l(5),n()()()),o&2){let e=t.$implicit,s=c(3);r(3),h("",e.amount," EGP"),r(2),P("",e.method," - ",s.formatDateTime(e.date))}}function je(o,t){if(o&1&&(i(0,"div",65),w(1,Le,6,3,"div",91,M),n()),o&2){let e=c(2);r(),E(e.selectedVisit().payments)}}function Be(o,t){if(o&1){let e=C();i(0,"button",120),m("click",function(){u(e);let a=c(2);return _(a.startVisit(a.selectedVisit().id))}),v(1,"lucide-icon",25),i(2,"span"),l(3,"Start Visit"),n()()}if(o&2){let e=c(2);r(),p("img",e.PlayIcon)("size",20)}}function We(o,t){if(o&1){let e=C();i(0,"button",121),m("click",function(){u(e);let a=c(2);return _(a.completeVisit())}),v(1,"lucide-icon",25),i(2,"span"),l(3,"Complete Visit"),n()()}if(o&2){let e=c(2);r(),p("img",e.CheckCircleIcon)("size",20)}}function Qe(o,t){if(o&1&&(i(0,"div",71),v(1,"lucide-icon",25),i(2,"span",122),l(3,"Visit Completed"),n()()),o&2){let e=c(2);r(),p("img",e.CheckCircleIcon)("size",20)}}function Ge(o,t){if(o&1){let e=C();i(0,"div",23)(1,"div",50)(2,"div",51)(3,"div")(4,"h2",5),l(5,"Visit Details"),n(),i(6,"p",6),l(7),n()(),i(8,"button",52),m("click",function(){u(e);let a=c();return _(a.closeDetailsModal())}),v(9,"lucide-icon",25),n()(),i(10,"div",53)(11,"div",54)(12,"div",55)(13,"p",56),l(14,"Status"),n(),i(15,"span"),v(16,"lucide-icon",57),l(17),n()(),i(18,"div",55)(19,"p",56),l(20,"Total Cost"),n(),i(21,"p",5),l(22),n()(),i(23,"div")(24,"p",56),l(25,"Balance"),n(),i(26,"p"),l(27),n()()(),x(28,he,16,2,"div",58)(29,be,3,2,"div",59),i(30,"div",58)(31,"div",60)(32,"h3",61),l(33,"Procedures"),n(),x(34,Ve,4,2,"button",62),n(),x(35,Se,12,3,"div",63),x(36,we,2,0,"p",64)(37,Te,3,0,"div",65),n(),i(38,"div",58)(39,"div",60)(40,"h3",61),l(41,"Prescription"),n(),x(42,Ie,4,2,"button",66),n(),x(43,De,14,0,"div",63),x(44,$e,7,2,"div",67)(45,Ne,2,0,"p",64),n(),i(46,"div",58)(47,"div",60)(48,"h3",61),l(49,"Payments"),n(),x(50,ze,4,2,"button",62),n(),x(51,Ae,17,4,"div",63),x(52,qe,2,0,"p",64)(53,je,3,0,"div",65),n(),i(54,"div",68),x(55,Be,4,2,"button",69)(56,We,4,2,"button",70)(57,Qe,4,2,"div",71),i(58,"button",72),m("click",function(){u(e);let a=c();return _(a.closeDetailsModal())}),l(59," Close "),n()()()()()}if(o&2){let e=c();r(7),P(" ",e.selectedVisit().patientName," - ",e.formatDateTime(e.selectedVisit().date)," "),r(2),p("img",e.XIcon)("size",24),r(6),F("px-4 py-2 rounded-full text-sm font-medium inline-flex items-center "+e.getStatusColor(e.selectedVisit().status)),r(),p("img",e.getStatusIcon(e.selectedVisit().status))("size",16),r(),h(" ",e.selectedVisit().status.toUpperCase().replace("-"," ")," "),r(5),h("",e.selectedVisit().totalCost," EGP"),r(),F("rounded-lg p-4 text-center "+(e.selectedVisit().balance>0?"bg-red-50":"bg-green-50")),r(3),F("text-2xl font-bold "+(e.selectedVisit().balance>0?"text-red-600":"text-green-600")),r(),h(" ",e.selectedVisit().balance," EGP "),r(),g(e.selectedVisit().status!=="completed"?28:29),r(6),g(e.selectedVisit().status!=="completed"?34:-1),r(),g(e.showProcedureForm()?35:-1),r(),g(e.selectedVisit().procedures.length===0?36:37),r(6),g(e.selectedVisit().status!=="completed"&&!e.selectedVisit().prescription?42:-1),r(),g(e.showPrescriptionForm()?43:-1),r(),g(e.selectedVisit().prescription?44:45),r(6),g(e.selectedVisit().balance>0?50:-1),r(),g(e.showPaymentForm()?51:-1),r(),g(e.selectedVisit().payments.length===0?52:53),r(3),g(e.selectedVisit().status==="waiting"?55:e.selectedVisit().status==="in-progress"?56:57)}}var se=class o{SearchIcon=K;PlusIcon=H;Edit2Icon=R;Trash2Icon=Y;PhoneIcon=U;CalendarIcon=j;FileTextIcon=O;DollarSignIcon=G;AlertCircleIcon=B;XIcon=Z;ClockIcon=Q;CheckCircleIcon=W;PlayIcon=X;PrinterIcon=J;searchQuery=f("");statusFilter=f("all");balanceFilter=f("all");showDetailsModal=f(!1);selectedVisit=f(null);showProcedureForm=f(!1);showPaymentForm=f(!1);showPrescriptionForm=f(!1);procedureForm=f({name:"",tooth:"",price:0});paymentForm=f({amount:0,method:"cash"});prescriptionItems=f([{medicine:"",dosage:"",frequency:"",duration:""}]);filteredVisits=A(()=>{let t=this.visitService.filterVisits(this.statusFilter(),this.balanceFilter()==="unpaid"),e=this.searchQuery().toLowerCase();return e?t.filter(s=>{let a=this.visitService.getVisitWithDetails(s.id,this.patientService);return a?a.patientName?.toLowerCase().includes(e)||a.patientPhone?.includes(e)||s.diagnosis?.toLowerCase().includes(e):!1}):t});patientService=T(ae);visitService=T(re);route=T(L);constructor(){}ngOnInit(){this.route.queryParams.subscribe(t=>{if(t.openVisit){let e=this.visitService.getVisitById(t.openVisit);e&&this.openDetailsModal(e)}})}setStatusFilter(t){this.statusFilter.set(t)}setBalanceFilter(t){this.balanceFilter.set(t)}onSearch(t){let e=t.target;this.searchQuery.set(e.value)}clearSearch(){this.searchQuery.set("")}openDetailsModal(t){let e=this.visitService.getVisitWithDetails(t.id,this.patientService);e&&(this.selectedVisit.set(e),this.showDetailsModal.set(!0),this.resetForms())}closeDetailsModal(){this.showDetailsModal.set(!1),this.selectedVisit.set(null),this.resetForms()}startVisit(t){try{this.visitService.startVisit(t),this.refreshSelectedVisit(),this.showSuccessMessage("Visit started successfully!")}catch(e){alert("Error: "+e.message)}}completeVisit(){let t=this.selectedVisit();if(t&&confirm("Complete this visit? This cannot be undone."))try{this.visitService.completeVisit(t.id),this.closeDetailsModal(),this.showSuccessMessage("Visit completed successfully!")}catch(e){alert("Error: "+e.message)}}saveDiagnosis(t,e){let s=this.selectedVisit();if(s)try{this.visitService.updateVisit(s.id,{diagnosis:t,notes:e}),this.refreshSelectedVisit(),this.showSuccessMessage("Notes saved!")}catch(a){alert("Error: "+a.message)}}deleteVisit(t){let e=this.visitService.getVisitWithDetails(t.id,this.patientService);if(e&&confirm(`Delete visit for ${e.patientName}? This will also delete all related procedures, payments, and prescriptions.`))try{this.visitService.deleteVisit(t.id),this.selectedVisit()?.id===t.id&&this.closeDetailsModal(),this.showSuccessMessage("Visit deleted successfully")}catch(s){alert("Error: "+s.message)}}toggleProcedureForm(){this.showProcedureForm.set(!this.showProcedureForm()),this.showProcedureForm()&&this.procedureForm.set({name:"",tooth:"",price:0})}addProcedure(){let t=this.selectedVisit();if(!t)return;let e=this.procedureForm();if(!e.name||e.price<=0){alert("Please enter procedure name and valid price");return}try{this.visitService.addProcedure(t.id,{name:e.name,tooth:e.tooth,price:e.price}),this.refreshSelectedVisit(),this.toggleProcedureForm(),this.showSuccessMessage("Procedure added!")}catch(s){alert("Error: "+s.message)}}removeProcedure(t){if(confirm("Remove this procedure?"))try{this.visitService.removeProcedure(t),this.refreshSelectedVisit(),this.showSuccessMessage("Procedure removed!")}catch(e){alert("Error: "+e.message)}}togglePaymentForm(){if(this.showPaymentForm.set(!this.showPaymentForm()),this.showPaymentForm()){let t=this.selectedVisit()?.balance||0;this.paymentForm.set({amount:t,method:"cash"})}}addPayment(){let t=this.selectedVisit();if(!t)return;let e=this.paymentForm();try{this.visitService.addPayment(t.id,{amount:e.amount,method:e.method}),this.refreshSelectedVisit(),this.togglePaymentForm(),this.showSuccessMessage("Payment recorded!")}catch(s){alert("Error: "+s.message)}}togglePrescriptionForm(){this.showPrescriptionForm.set(!this.showPrescriptionForm()),this.showPrescriptionForm()&&this.prescriptionItems.set([{medicine:"",dosage:"",frequency:"",duration:""}])}addPrescriptionItem(){this.prescriptionItems.update(t=>[...t,{medicine:"",dosage:"",frequency:"",duration:""}])}updatePrescriptionItem(t,e,s){this.prescriptionItems.update(a=>{let d=[...a];return d[t]=S(V({},d[t]),{[e]:s}),d})}savePrescription(){let t=this.selectedVisit();if(!t)return;let e=this.prescriptionItems().filter(s=>s.medicine&&s.dosage);if(e.length===0){alert("Please add at least one medicine with dosage");return}try{this.visitService.addPrescription(t.id,e),this.refreshSelectedVisit(),this.togglePrescriptionForm(),this.showSuccessMessage("Prescription saved!")}catch(s){alert("Error: "+s.message)}}printPrescription(){let t=this.selectedVisit();if(!t||!t.prescription)return;let e=`
      <div style="padding: 40px; font-family: Arial;">
        <h1 style="text-align: center; border-bottom: 3px solid #333; padding-bottom: 10px;">Dental Clinic</h1>
        <p style="text-align: center; margin: 10px 0;">123 Main Street | Phone: (123) 456-7890</p>

        <div style="margin: 30px 0;">
          <p><strong>Date:</strong> ${this.formatDate(t.prescription.date)}</p>
          <p><strong>Patient:</strong> ${t.patientName}</p>
          <p><strong>Phone:</strong> ${t.patientPhone}</p>
        </div>

        <h2 style="border-bottom: 2px solid #666; padding-bottom: 5px;">Prescription</h2>

        ${t.prescription.items.map((a,d)=>`
          <div style="margin: 20px 0; padding: 15px; background: #f5f5f5; border-left: 4px solid #333;">
            <p style="font-size: 18px; font-weight: bold; margin-bottom: 8px;">${d+1}. ${a.medicine}</p>
            <p style="margin: 4px 0;"><strong>Dosage:</strong> ${a.dosage}</p>
            <p style="margin: 4px 0;"><strong>Frequency:</strong> ${a.frequency}</p>
            <p style="margin: 4px 0;"><strong>Duration:</strong> ${a.duration}</p>
          </div>
        `).join("")}

        <div style="margin-top: 60px;">
          <p>_________________________</p>
          <p>Doctor's Signature</p>
        </div>
      </div>
    `,s=window.open("","","width=800,height=600");s&&(s.document.write(e),s.document.close(),s.print())}refreshSelectedVisit(){let t=this.selectedVisit();if(t){let e=this.visitService.getVisitWithDetails(t.id,this.patientService);e&&this.selectedVisit.set(e)}}resetForms(){this.showProcedureForm.set(!1),this.showPaymentForm.set(!1),this.showPrescriptionForm.set(!1),this.procedureForm.set({name:"",tooth:"",price:0}),this.paymentForm.set({amount:0,method:"cash"}),this.prescriptionItems.set([{medicine:"",dosage:"",frequency:"",duration:""}])}getStatusColor(t){switch(t){case"waiting":return"bg-yellow-100 text-yellow-800";case"in-progress":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getStatusIcon(t){switch(t){case"waiting":return this.ClockIcon;case"in-progress":return this.PlayIcon;case"completed":return this.CheckCircleIcon;default:return this.ClockIcon}}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}formatDateTime(t){return new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatPhone(t){return t.length===11?t.replace(/(\d{4})(\d{3})(\d{4})/,"$1 $2 $3"):t}showSuccessMessage(t){alert("\u2705 "+t)}updateAmount(t){this.paymentForm.set(S(V({},this.paymentForm()),{amount:+t}))}updateMethod(t){this.paymentForm.set(S(V({},this.paymentForm()),{method:t}))}updateProcedureName(t){this.procedureForm.set(S(V({},this.procedureForm()),{name:t}))}updateProcedureTooth(t){this.procedureForm.set(S(V({},this.procedureForm()),{tooth:t}))}updateProcedurePrice(t){this.procedureForm.set(S(V({},this.procedureForm()),{price:+t}))}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=$({type:o,selectors:[["app-visit"]],decls:33,vars:10,consts:[["diagnosisInput",""],["notesInput",""],[1,"h-full","bg-gray-50"],[1,"bg-white","border-b","border-gray-200","px-8","py-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-sm","text-gray-500","mt-1"],[1,"bg-white","border-b","border-gray-200","px-8","py-4"],[1,"flex","items-center","space-x-4"],[1,"flex-1","relative"],[1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-400",3,"img","size"],["type","text","placeholder","Search by patient name, phone, or diagnosis...",1,"w-full","pl-10","pr-10","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","text-gray-400","hover:text-gray-600"],[1,"px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"change","value"],["value","all"],["value","waiting"],["value","in-progress"],["value","completed"],["value","unpaid"],[1,"p-8"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"text-center","py-16"],[1,"divide-y","divide-gray-200"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","text-gray-400","hover:text-gray-600",3,"click"],[3,"img","size"],[1,"mx-auto","text-gray-400","mb-4",3,"img","size"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-500","mb-4"],[1,"text-blue-600","hover:text-blue-700","font-medium",3,"click"],[1,"text-gray-500"],[1,"p-6","hover:bg-gray-50","transition-colors","cursor-pointer"],[1,"p-6","hover:bg-gray-50","transition-colors","cursor-pointer",3,"click"],[1,"flex","items-center","space-x-4","flex-1"],[1,"w-12","h-12","rounded-full","bg-gradient-to-br","from-blue-500","to-purple-600","flex","items-center","justify-center"],[1,"text-white",3,"img","size"],[1,"flex-1"],[1,"flex","items-center","space-x-3","mb-1"],[1,"font-semibold","text-gray-900","text-lg"],[1,"flex","items-center","space-x-4","text-sm","text-gray-500"],[1,"flex","items-center"],[1,"mr-1",3,"img","size"],[1,"mt-2","text-sm","text-gray-700","line-clamp-1"],[1,"flex","items-center","space-x-6"],[1,"text-right"],[1,"text-sm","text-gray-500"],[1,"text-lg","font-bold","text-gray-900"],[1,"text-sm","font-medium","text-red-600"],[1,"text-sm","font-medium","text-green-600"],["title","Delete Visit",1,"p-2","text-gray-600","hover:text-red-600","hover:bg-red-50","rounded-lg","transition-colors",3,"click"],[1,"bg-white","rounded-xl","shadow-xl","w-full","max-w-6xl","max-h-[90vh]","overflow-y-auto"],[1,"flex","items-center","justify-between","p-6","border-b","border-gray-200","sticky","top-0","bg-white","z-10"],[1,"text-gray-400","hover:text-gray-600","transition-colors",3,"click"],[1,"p-6","space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"bg-gray-50","rounded-lg","p-4","text-center"],[1,"text-sm","text-gray-600","mb-2"],[1,"mr-2",3,"img","size"],[1,"bg-white","border","border-gray-200","rounded-lg","p-6"],[1,"bg-gray-50","rounded-lg","p-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"font-bold","text-lg"],[1,"flex","items-center","space-x-2","px-3","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-colors","text-sm"],[1,"mb-4","p-4","bg-gray-50","rounded-lg"],[1,"text-gray-500","text-center","py-4"],[1,"space-y-2"],[1,"flex","items-center","space-x-2","px-3","py-2","bg-purple-600","text-white","rounded-lg","hover:bg-purple-700","transition-colors","text-sm"],[1,"space-y-3"],[1,"flex","items-center","justify-between","pt-6","border-t","border-gray-200"],[1,"flex","items-center","space-x-2","px-6","py-3","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors","font-medium"],[1,"flex","items-center","space-x-2","px-6","py-3","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-colors","font-medium"],[1,"flex","items-center","space-x-2","text-green-600"],[1,"px-6","py-3","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors","font-medium",3,"click"],[1,"font-bold","text-lg","mb-4"],[1,"space-y-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["rows","3","placeholder","Enter diagnosis...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"value"],["rows","2","placeholder","Additional notes...",1,"w-full","px-4","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"value"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"mb-4"],[1,"text-sm","font-medium","text-gray-700","mb-1"],[1,"text-gray-900"],[1,"flex","items-center","space-x-2","px-3","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-colors","text-sm",3,"click"],[1,"font-semibold","mb-3"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-3"],["type","text","placeholder","Procedure name",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],["type","text","placeholder","Tooth # (optional)",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],["type","number","placeholder","Price",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],[1,"flex","space-x-2","mt-3"],[1,"px-4","py-2","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-colors","text-sm",3,"click"],[1,"px-4","py-2","border","border-gray-300","rounded-lg","hover:bg-gray-50","transition-colors","text-sm",3,"click"],[1,"flex","items-center","justify-between","p-3","bg-gray-50","rounded-lg"],[1,"font-medium","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","space-x-3"],[1,"font-bold","text-gray-900"],[1,"text-red-600","hover:text-red-800"],[1,"text-red-600","hover:text-red-800",3,"click"],[1,"flex","items-center","space-x-2","px-3","py-2","bg-purple-600","text-white","rounded-lg","hover:bg-purple-700","transition-colors","text-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-2","p-3","bg-white","rounded","border","border-gray-200"],[1,"px-4","py-2","text-blue-600","hover:bg-blue-50","rounded-lg","transition-colors","text-sm",3,"click"],[1,"ml-auto","flex","space-x-2"],[1,"px-4","py-2","bg-purple-600","text-white","rounded-lg","hover:bg-purple-700","transition-colors","text-sm",3,"click"],["type","text","placeholder","Medicine name",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],["type","text","placeholder","Dosage",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],["type","text","placeholder","Frequency",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],["type","text","placeholder","Duration",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value"],[1,"p-4","bg-gray-50","rounded-lg"],[1,"flex","items-center","space-x-2","px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors","text-sm",3,"click"],[1,"font-semibold","text-gray-900","mb-2"],[1,"grid","grid-cols-3","gap-2","text-sm"],[1,"text-gray-600"],[1,"ml-1","text-gray-900"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3"],["type","number","placeholder","Amount",1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"input","value","max"],[1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"change","value"],["value","cash"],["value","visa"],["value","bank"],[1,"text-sm","text-gray-600","capitalize"],[1,"flex","items-center","space-x-2","px-6","py-3","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors","font-medium",3,"click"],[1,"flex","items-center","space-x-2","px-6","py-3","bg-green-600","text-white","rounded-lg","hover:bg-green-700","transition-colors","font-medium",3,"click"],[1,"font-medium"]],template:function(e,s){e&1&&(i(0,"div",2)(1,"div",3)(2,"div",4)(3,"div")(4,"h1",5),l(5,"All Visits"),n(),i(6,"p",6),l(7),n()()()(),i(8,"div",7)(9,"div",8)(10,"div",9),v(11,"lucide-icon",10),i(12,"input",11),m("input",function(d){return s.onSearch(d)}),n(),x(13,le,2,2,"button",12),n(),i(14,"select",13),m("change",function(d){return s.setStatusFilter(d.target.value)}),i(15,"option",14),l(16,"All Status"),n(),i(17,"option",15),l(18,"Waiting"),n(),i(19,"option",16),l(20,"In Progress"),n(),i(21,"option",17),l(22,"Completed"),n()(),i(23,"select",13),m("change",function(d){return s.setBalanceFilter(d.target.value)}),i(24,"option",14),l(25,"All Balances"),n(),i(26,"option",18),l(27,"Unpaid Only"),n()()()(),i(28,"div",19)(29,"div",20),x(30,me,4,3,"div",21)(31,Ce,3,0,"div",22),n()()(),x(32,Ge,60,26,"div",23)),e&2&&(r(7),P(" ",s.filteredVisits().length," visit",s.filteredVisits().length!==1?"s":""," found "),r(4),p("img",s.SearchIcon)("size",20),r(),p("value",s.searchQuery()),r(),g(s.searchQuery()?13:-1),r(),p("value",s.statusFilter()),r(9),p("value",s.balanceFilter()),r(7),g(s.filteredVisits().length===0?30:31),r(2),g(s.showDetailsModal()&&s.selectedVisit()?32:-1))},dependencies:[q,oe,ie,ne,te,ee],encapsulation:2})};export{se as VisitComponent};
